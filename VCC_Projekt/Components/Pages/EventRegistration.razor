@page "/signup-event"
@using System.ComponentModel.DataAnnotations

<PageTitle>Event-Anmeldung</PageTitle>

<div class="container mt-5">
    <div class="text-center">
        <h1 class="display-4 font-weight-bold" style="color: #134883;">Anmeldung für Event</h1>
        <p class="lead text-muted">
            Wähle deine Teilnahmeart und registriere dich für das Event.
        </p>
    </div>

    <div class="mt-4">
        <EditForm Model="@Input" OnValidSubmit="@HandleSubmit" method="post" FormName="eventRegistration">
            <DataAnnotationsValidator />

            <div class="form-check mb-3">
                <InputRadioGroup @bind-Value="Input.ParticipationType" Name="participation">
                    <InputRadio Value="@ParticipationTypeSingle" id="single" />
                    <label for="single">@ParticipationTypeSingle</label>
                    <br />
                    <InputRadio Value="@ParticipationTypeTeam" id="team"/>
                    <label for="team">@ParticipationTypeTeam</label>
                </InputRadioGroup>
                <ValidationMessage For="@(() => Input.ParticipationType)" class="text-danger" />
            </div>

            @if (Input.ParticipationType == ParticipationTypeTeam)
            {
                <div class="text-center">
                    <p class="lead text-muted">
                        Um als Team am Event teilzunehmen, sollte der Gruppenmanager eine Gruppe mit Teamnamen anlegen & die E-Mail-Adressen deiner Freunde hinzufügen. <br>
                        Diese erhalten automatisch ein Einladungsmail - nachdem sie dieses bestätigt haben, sind sie Mitglieder deiner Gruppe.
                    </p>
                </div>

                <div class="form-floating mb-3">
                    <InputText @bind-Value="Input.TeamName" class="form-control"/>
                    <label for="teamname">Teamname</label>
                    <ValidationMessage For="@(() => Input.TeamName)" class="text-danger" />
                </div>

                <div class="mb-3">
                    <h5>Teammitglieder hinzufügen</h5>
                    @foreach (var email in Input.TeamMembers)
                    {
                        <div class="input-group mb-2">
                            <input type="email" class="form-control" value="@email" readonly />
                            <button type="button" class="btn btn-success" @onclick="() => RemoveMember(email)">Entfernen</button>
                        </div>
                    }
                    <div class="input-group">
                        <input type="email" class="form-control" @bind="Input.NewMemberEmail" placeholder="E-Mail-Adresse hinzufügen" />
                        <button type="button" class="btn btn-success" @onclick="AddMember">Hinzufügen</button>
                        <ValidationMessage For="@(() => Input.NewMemberEmail)" class="text-danger" />
                    </div>
                    <ValidationMessage For="@(() => Input.TeamMembers)" class="text-danger" />
                </div>
            }

            @if (Input.ParticipationType == ParticipationTypeSingle)
            {
                <div class="text-center">
                    <p class="lead text-muted">
                        Um als Einzelkämpfer am Event teilzunehmen, kontrolliere bitte deinen Benutzername und bestätige.
                    </p>
                </div>

                <div class="form-floating mb-3">
                    <InputText @bind-Value="@User.Identity.Name" class="form-control" disabled/>
                    <label for="teamname">Benutzername</label>
                </div>
            }

            <div class="text-center mt-5">
                <button type="submit" class="w-25 btn btn-lg btn-success">Anmelden</button>
            </div>
        </EditForm>
    </div>

    <div class="text-center mt-4">
        <a class="btn btn-link" href="/events">Zurück zu den Events</a>
    </div>
</div>

<style>
    body {
        background-color: #f8f9fa;
    }

    .btn-success {
        background-color: #134883;
        border-color: #134883;
    }

        .btn-success:hover {
            background-color: #2f5e91;
            border-color: #2f5e91;
        }

    h1, h2, h3 {
        color: #134883;
    }

    .form-control {
        border: 2px solid #134883;
    }

        .form-control:focus {
            border-color: #2f5e91;
            box-shadow: 0 0 5px rgba(47, 94, 145, 0.5);
        }
</style>